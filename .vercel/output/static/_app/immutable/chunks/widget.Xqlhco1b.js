import{s as Q,a as V,e as m,g as R,c as _,b as T,f as g,m as u,i as E,n as W,M as X,J as Z,N as x,G as q,x as M,w as P,h,C,o as I,p as J,y as A,t as $,d as ee,O as te}from"./scheduler.DCRTzJa9.js";import{S as ne,i as se}from"./index.ry5Ra-Ly.js";import{R as ie,a as j,s as ae}from"./firebase.ldIwJ5_z.js";import{a as B}from"./store.-1J7pbUR.js";import{c as re}from"./utils.W3KuLhvY.js";function le(r){let t,e,l,a,n,s,d="Confirm",p,y,i=!r[3]?.ok&&F(r);return{c(){t=m("form"),i&&i.c(),e=V(),l=m("div"),a=m("input"),n=V(),s=m("button"),s.textContent=d,this.h()},l(c){t=_(c,"FORM",{class:!0});var o=T(t);i&&i.l(o),e=R(o),l=_(o,"DIV",{class:!0});var w=T(l);a=_(w,"INPUT",{class:!0,name:!0,placeholder:!0,maxlength:!0}),w.forEach(g),n=R(o),s=_(o,"BUTTON",{class:!0,"data-svelte-h":!0}),M(s)!=="svelte-r4cedt"&&(s.textContent=d),o.forEach(g),this.h()},h(){a.required=!0,u(a,"class","p-2 w-full"),u(a,"name","confirmation-code"),u(a,"placeholder","Confirmation Code"),u(a,"maxlength","6"),u(l,"class","yuzui"),u(s,"class","yuzui"),P(s,"loading",r[2]),u(t,"class","yuzui-column")},m(c,o){E(c,t,o),i&&i.m(t,null),h(t,e),h(t,l),h(l,a),r[18](a),C(a,r[1]),h(t,n),h(t,s),p||(y=[I(a,"input",r[19]),I(t,"submit",J(r[20]))],p=!0)},p(c,o){c[3]?.ok?i&&(i.d(1),i=null):i?i.p(c,o):(i=F(c),i.c(),i.m(t,e)),o&2&&a.value!==c[1]&&C(a,c[1]),o&4&&P(s,"loading",c[2])},d(c){c&&g(t),i&&i.d(),r[18](null),p=!1,A(y)}}}function oe(r){let t,e,l,a,n,s="1",d,p,y,i,c,o,w="Sign In",S,z;return{c(){t=m("form"),e=m("div"),l=m("div"),a=$(`+
				`),n=m("span"),n.textContent=s,d=V(),p=m("input"),y=V(),i=m("input"),c=V(),o=m("button"),o.textContent=w,this.h()},l(b){t=_(b,"FORM",{class:!0});var v=T(t);e=_(v,"DIV",{class:!0});var N=T(e);l=_(N,"DIV",{class:!0});var k=T(l);a=ee(k,`+
				`),n=_(k,"SPAN",{class:!0,contenteditable:!0,role:!0,"data-svelte-h":!0}),M(n)!=="svelte-11d1a8r"&&(n.textContent=s),d=R(k),p=_(k,"INPUT",{class:!0,name:!0}),k.forEach(g),y=R(N),i=_(N,"INPUT",{name:!0,class:!0,placeholder:!0}),N.forEach(g),c=R(v),o=_(v,"BUTTON",{class:!0,"data-svelte-h":!0}),M(o)!=="svelte-uk0bq5"&&(o.textContent=w),v.forEach(g),this.h()},h(){u(n,"class","px-1 focus-visible:outline-0"),u(n,"contenteditable","true"),u(n,"role","textbox"),u(p,"class","hidden"),u(p,"name","countryCode"),u(l,"class","flex"),u(i,"name","phone"),i.required=!0,u(i,"class","w-full border-b-0 py-2"),u(i,"placeholder","(111) 111-1111"),u(e,"class","flex items-center yuzui gap-2 px-2"),u(o,"class","yuzui"),P(o,"loading",r[2]),u(t,"class","yuzui-column")},m(b,v){E(b,t,v),h(t,e),h(e,l),h(l,a),h(l,n),h(l,d),h(l,p),C(p,r[5]),h(e,y),h(e,i),r[14](i),C(i,r[0]),h(t,c),h(t,o),S||(z=[I(n,"input",r[12]),I(p,"input",r[13]),I(i,"input",r[15]),te(re.call(null,i,{delimiters:["(",") ","-"],blocks:[0,3,3,4],numericOnly:!0})),I(t,"submit",J(r[10]))],S=!0)},p(b,v){v&32&&p.value!==b[5]&&C(p,b[5]),v&1&&i.value!==b[0]&&C(i,b[0]),v&4&&P(o,"loading",b[2])},d(b){b&&g(t),r[14](null),S=!1,A(z)}}}function F(r){let t,e,l,a;return{c(){t=m("div"),e=m("input"),this.h()},l(n){t=_(n,"DIV",{class:!0});var s=T(t);e=_(s,"INPUT",{class:!0,name:!0,placeholder:!0}),s.forEach(g),this.h()},h(){e.required=!0,u(e,"class","p-2 w-full"),u(e,"name","name"),u(e,"placeholder","Your name"),u(t,"class","yuzui")},m(n,s){E(n,t,s),h(t,e),r[16](e),C(e,r[4]),l||(a=I(e,"input",r[17]),l=!0)},p(n,s){s&16&&e.value!==n[4]&&C(e,n[4])},d(n){n&&g(t),r[16](null),l=!1,a()}}}function ue(r){let t,e;function l(s,d){return s[3]?le:oe}let a=l(r),n=a(r);return{c(){n.c(),t=V(),e=m("div"),this.h()},l(s){n.l(s),t=R(s),e=_(s,"DIV",{id:!0}),T(e).forEach(g),this.h()},h(){u(e,"id","recaptcha-div")},m(s,d){n.m(s,d),E(s,t,d),E(s,e,d)},p(s,[d]){a===(a=l(s))&&n?n.p(s,d):(n.d(1),n=a(s),n&&(n.c(),n.m(t.parentNode,t)))},i:W,o:W,d(s){s&&(g(t),g(e)),n.d(s)}}}function ce(r,t,e){let l="",a="",n=!1,s,d="",p="1",y,i,c;const o=X();Z(async()=>(y?.focus(),window.recaptchaVerifier=new ie("recaptcha-div",{size:"invisible"},j),window.recaptchaVerifier.render(),()=>{window.recaptchaVerifier.clear()}));const w=async()=>{e(2,n=!0);try{e(3,s=await S("+"+p+l)),await x(),i?i.focus():c&&c.focus()}catch(f){console.log(f),B("There was an issue verifiying your number")}e(2,n=!1)},S=async f=>{const D=window.recaptchaVerifier,U=await ae(j,f,D),O=await fetch("/api/auth",{headers:{"x-phone-number":f}}),{message:L}=await O.json();return{confirmationResult:U,ok:L==="ok"}},z=async(f,D,U)=>{const O=await U.confirm(f);return await fetch("/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:D,idToken:await O.user.getIdToken()})}),O},b=f=>{f.target.textContent=f.target.textContent.replace(/\D/g,""),f.target.textContent=f.target.textContent.slice(0,3),e(5,p=f.target.textContent)};function v(){p=this.value,e(5,p)}function N(f){q[f?"unshift":"push"](()=>{y=f,e(6,y)})}function k(){l=this.value,e(0,l)}function G(f){q[f?"unshift":"push"](()=>{i=f,e(7,i)})}function Y(){d=this.value,e(4,d)}function H(f){q[f?"unshift":"push"](()=>{c=f,e(8,c)})}function K(){a=this.value,e(1,a)}return[l,a,n,s,d,p,y,i,c,o,w,z,b,v,N,k,G,Y,H,K,async()=>{e(2,n=!0);try{await z(a,d,s.confirmationResult),o("signin")}catch{e(1,a=""),B("Invalid code"),e(2,n=!1)}}]}class be extends ne{constructor(t){super(),se(this,t,ce,ue,Q,{})}}export{be as W};
