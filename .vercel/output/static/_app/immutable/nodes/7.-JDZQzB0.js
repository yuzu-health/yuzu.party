import{s as me,a as S,I as pe,f as _,g as $,i as j,J as he,e as d,c as m,b as I,x as V,m as c,C as F,h as o,o as M,y as de,t as Z,d as J,w as se,p as _e,K as ne,E as ve,n as ge,j as K}from"../chunks/scheduler.DCRTzJa9.js";import{S as ye,i as be,b as W,d as G,m as Q,a as X,t as Y,f as ee}from"../chunks/index.ry5Ra-Ly.js";import{e as oe}from"../chunks/each.PK6sAFCL.js";import{i as we}from"../chunks/browser-image-compression.3GdFFIbm.js";import{i as re}from"../chunks/navigation.AbnT0D0z.js";import{a as Ce}from"../chunks/firebase.ldIwJ5_z.js";import{a as ie}from"../chunks/store.-1J7pbUR.js";import{P as xe}from"../chunks/ProfilePic.61gLdwPY.js";import{L as Ee}from"../chunks/Layout.wAdxJ5Ve.js";import{C as Pe}from"../chunks/Camera.9YlvSJO5.js";function ce(r,e,t){const a=r.slice();return a[13]=e[t],a[15]=t,a}function Ie(r){let e,t=oe(r[4]),a=[];for(let l=0;l<t.length;l+=1)a[l]=fe(ce(r,t,l));return{c(){for(let l=0;l<a.length;l+=1)a[l].c();e=ne()},l(l){for(let n=0;n<a.length;n+=1)a[n].l(l);e=ne()},m(l,n){for(let s=0;s<a.length;s+=1)a[s]&&a[s].m(l,n);j(l,e,n)},p(l,n){if(n&16){t=oe(l[4]);let s;for(s=0;s<t.length;s+=1){const g=ce(l,t,s);a[s]?a[s].p(g,n):(a[s]=fe(g),a[s].c(),a[s].m(e.parentNode,e))}for(;s<a.length;s+=1)a[s].d(1);a.length=t.length}},d(l){l&&_(e),ve(a,l)}}}function ke(r){let e,t="fetching...";return{c(){e=d("div"),e.textContent=t,this.h()},l(a){e=m(a,"DIV",{class:!0,"data-svelte-h":!0}),V(e)!=="svelte-qrzu3t"&&(e.textContent=t),this.h()},h(){c(e,"class","grow yuzui flex items-center justify-center h-full")},m(a,l){j(a,e,l)},p:ge,d(a){a&&_(e)}}}function ue(r){let e,t=r[13].location+"",a;return{c(){e=d("div"),a=Z(t),this.h()},l(l){e=m(l,"DIV",{class:!0});var n=I(e);a=J(n,t),n.forEach(_),this.h()},h(){c(e,"class","overflow-hidden text-ellipsis mt-1")},m(l,n){j(l,e,n),o(e,a)},p(l,n){n&16&&t!==(t=l[13].location+"")&&K(a,t)},d(l){l&&_(e)}}}function fe(r){let e,t,a=r[13].name+"",l,n,s,g,w=new Date(r[13]?.date).toLocaleString("en-US",{weekday:"long",month:"long",day:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"})+"",b,y,h,k,i=r[13].location&&ue(r);return{c(){e=d("a"),t=d("div"),l=Z(a),n=S(),s=d("div"),g=d("div"),b=Z(w),y=S(),i&&i.c(),h=S(),this.h()},l(v){e=m(v,"A",{class:!0,href:!0});var p=I(e);t=m(p,"DIV",{class:!0});var f=I(t);l=J(f,a),f.forEach(_),n=$(p),s=m(p,"DIV",{class:!0});var P=I(s);g=m(P,"DIV",{});var C=I(g);b=J(C,w),C.forEach(_),y=$(P),i&&i.l(P),P.forEach(_),h=$(p),p.forEach(_),this.h()},h(){c(t,"class","w-[100%] text-ellipsis overflow-hidden mb-2 font-medium"),c(s,"class","w-[100%] opacity-50"),c(e,"class","yuzui block p-2 w-full"),c(e,"href",k="/"+r[13].id)},m(v,p){j(v,e,p),o(e,t),o(t,l),o(e,n),o(e,s),o(s,g),o(g,b),o(s,y),i&&i.m(s,null),o(e,h)},p(v,p){p&16&&a!==(a=v[13].name+"")&&K(l,a),p&16&&w!==(w=new Date(v[13]?.date).toLocaleString("en-US",{weekday:"long",month:"long",day:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"})+"")&&K(b,w),v[13].location?i?i.p(v,p):(i=ue(v),i.c(),i.m(s,null)):i&&(i.d(1),i=null),p&16&&k!==(k="/"+v[13].id)&&c(e,"href",k)},d(v){v&&_(e),i&&i.d()}}}function Ne(r){let e,t,a,l="Parties",n,s,g,w="Sort By",b,y,h,k="All ",i,v="Upcoming",p,f="Hosting",P,C,A,x,H='<span class="px-2 bg-light font-semibold">Create a party</span>',z,q;function U(D,u){return D[4]?.length?Ie:ke}let L=U(r),N=L(r);return{c(){e=d("div"),t=d("div"),a=d("span"),a.textContent=l,n=S(),s=d("span"),g=d("span"),g.textContent=w,b=S(),y=d("select"),h=d("option"),h.textContent=k,i=d("option"),i.textContent=v,p=d("option"),p.textContent=f,P=S(),C=d("div"),N.c(),A=S(),x=d("a"),x.innerHTML=H,this.h()},l(D){e=m(D,"DIV",{class:!0,slot:!0});var u=I(e);t=m(u,"DIV",{class:!0});var E=I(t);a=m(E,"SPAN",{class:!0,"data-svelte-h":!0}),V(a)!=="svelte-17mcvv9"&&(a.textContent=l),n=$(E),s=m(E,"SPAN",{class:!0});var T=I(s);g=m(T,"SPAN",{class:!0,"data-svelte-h":!0}),V(g)!=="svelte-1cwqabz"&&(g.textContent=w),b=$(T),y=m(T,"SELECT",{class:!0});var O=I(y);h=m(O,"OPTION",{"data-svelte-h":!0}),V(h)!=="svelte-1vc05mt"&&(h.textContent=k),i=m(O,"OPTION",{"data-svelte-h":!0}),V(i)!=="svelte-2m822"&&(i.textContent=v),p=m(O,"OPTION",{"data-svelte-h":!0}),V(p)!=="svelte-o5opdq"&&(p.textContent=f),O.forEach(_),T.forEach(_),E.forEach(_),P=$(u),C=m(u,"DIV",{class:!0});var R=I(C);N.l(R),R.forEach(_),A=$(u),x=m(u,"A",{href:!0,class:!0,"data-svelte-h":!0}),V(x)!=="svelte-1k5mngf"&&(x.innerHTML=H),u.forEach(_),this.h()},h(){c(a,"class","font-medium p-2 flex flex-row items-center w-full"),c(g,"class","font-light opacity-50"),h.selected=!0,h.__value="all",F(h,h.__value),i.__value="upcoming",F(i,i.__value),p.__value="hosting",F(p,p.__value),c(y,"class","h-10 text-primary accent-primary"),c(s,"class","float-right pr-2 whitespace-pre"),c(t,"class","yuzui flex"),c(C,"class","yuzui yuzui-column grow"),c(x,"href","/"),c(x,"class","yuzui sticky bottom-0 text-center yuzui-bg-dots -mt-[1px]"),c(e,"class","h-[calc(100%-90px)] sm:max-h-[34rem] mt-[5px] sm:mt-0 -mr-[1px] yuzui-column"),c(e,"slot","col1")},m(D,u){j(D,e,u),o(e,t),o(t,a),o(t,n),o(t,s),o(s,g),o(s,b),o(s,y),o(y,h),o(y,i),o(y,p),o(e,P),o(e,C),N.m(C,null),o(e,A),o(e,x),z||(q=[M(y,"change",r[7]),M(C,"scroll",r[12])],z=!0)},p(D,u){L===(L=U(D))&&N?N.p(D,u):(N.d(1),N=L(D),N&&(N.c(),N.m(C,null)))},d(D){D&&_(e),N.d(),z=!1,de(q)}}}function ze(r){let e,t,a,l="Profile",n,s,g="Sign out",w,b,y,h,k,i,v,p,f,P,C,A,x,H,z,q,U,L,N,D;return v=new Pe({props:{class:"h-10 w-10 p-1"}}),f=new xe({props:{class:"h-20 w-20 yuzui-bg-dots border border-current object-cover",src:r[5],uid:r[0]?.uid}}),{c(){e=d("form"),t=d("div"),a=d("div"),a.textContent=l,n=S(),s=d("button"),s.textContent=g,w=S(),b=d("div"),y=d("div"),h=d("label"),k=d("div"),i=d("span"),W(v.$$.fragment),p=S(),W(f.$$.fragment),P=S(),C=d("input"),A=S(),x=d("input"),H=S(),z=d("button"),q=Z("Save Profile"),this.h()},l(u){e=m(u,"FORM",{class:!0,slot:!0});var E=I(e);t=m(E,"DIV",{class:!0});var T=I(t);a=m(T,"DIV",{class:!0,"data-svelte-h":!0}),V(a)!=="svelte-snk5xn"&&(a.textContent=l),n=$(T),s=m(T,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),V(s)!=="svelte-1mxzaw7"&&(s.textContent=g),T.forEach(_),w=$(E),b=m(E,"DIV",{class:!0});var O=I(b);y=m(O,"DIV",{class:!0});var R=I(y);h=m(R,"LABEL",{class:!0});var B=I(h);k=m(B,"DIV",{class:!0});var te=I(k);i=m(te,"SPAN",{class:!0});var ae=I(i);G(v.$$.fragment,ae),ae.forEach(_),te.forEach(_),p=$(B),G(f.$$.fragment,B),P=$(B),C=m(B,"INPUT",{class:!0,name:!0,type:!0,accept:!0}),B.forEach(_),R.forEach(_),A=$(O),x=m(O,"INPUT",{maxlength:!0,class:!0}),O.forEach(_),H=$(E),z=m(E,"BUTTON",{class:!0});var le=I(z);q=J(le,"Save Profile"),le.forEach(_),E.forEach(_),this.h()},h(){c(a,"class","yuzui p-2 font-medium w-full -mr-[1px]"),c(s,"type","button"),c(s,"class","yuzui whitespace-pre"),c(t,"class","yuzui-row"),c(i,"class","bg-light"),c(k,"class","h-20 w-20 absolute left-0 top-0 flex items-center justify-center"),c(C,"class","hidden"),c(C,"name","avatar"),c(C,"type","file"),c(C,"accept","image/*"),c(h,"class","relative cursor-pointer"),c(y,"class","inline-block"),x.required=!0,c(x,"maxlength","20"),c(x,"class","focus-visible:outline-0 border-b inline-block pb-1"),c(b,"class","yuzui !border-b-0 overflow-y-auto h-full -mt-[1px] p-4 flex gap-4 flex-col"),c(z,"class","yuzui"),z.disabled=U=!r[2]||r[2]===r[0]?.displayName&&!r[1]?.[0],se(z,"loading",r[3]),c(e,"class","h-[calc(100%-90px)] sm:max-h-[34rem] mt-[5px] sm:mt-0 flex flex-col"),c(e,"slot","col2")},m(u,E){j(u,e,E),o(e,t),o(t,a),o(t,n),o(t,s),o(e,w),o(e,b),o(b,y),o(y,h),o(h,k),o(k,i),Q(v,i,null),o(h,p),Q(f,h,null),o(h,P),o(h,C),o(b,A),o(b,x),F(x,r[2]),o(e,H),o(e,z),o(z,q),L=!0,N||(D=[M(s,"click",r[9]),M(C,"change",r[10]),M(x,"input",r[11]),M(e,"submit",_e(r[8]))],N=!0)},p(u,E){const T={};E&32&&(T.src=u[5]),E&1&&(T.uid=u[0]?.uid),f.$set(T),E&4&&x.value!==u[2]&&F(x,u[2]),(!L||E&7&&U!==(U=!u[2]||u[2]===u[0]?.displayName&&!u[1]?.[0]))&&(z.disabled=U),(!L||E&8)&&se(z,"loading",u[3])},i(u){L||(X(v.$$.fragment,u),X(f.$$.fragment,u),L=!0)},o(u){Y(v.$$.fragment,u),Y(f.$$.fragment,u),L=!1},d(u){u&&_(e),ee(v),ee(f),N=!1,de(D)}}}function De(r){let e,t,a;return t=new Ee({props:{$$slots:{col2:[ze],col1:[Ne]},$$scope:{ctx:r}}}),{c(){e=S(),W(t.$$.fragment),this.h()},l(l){pe("svelte-1u2dft7",document.head).forEach(_),e=$(l),G(t.$$.fragment,l),this.h()},h(){document.title="Profile"},m(l,n){j(l,e,n),Q(t,l,n),a=!0},p(l,[n]){const s={};n&65599&&(s.$$scope={dirty:n,ctx:l}),t.$set(s)},i(l){a||(X(t.$$.fragment,l),a=!0)},o(l){Y(t.$$.fragment,l),a=!1},d(l){l&&_(e),ee(t,l)}}}function Se(r,e,t){let a,{data:l}=e,n,s=l.displayName||"",g=!1,w;const b=async()=>{const f=await fetch(`/api/party/list?startAfter=${w?.[w.length-1]?.id||""}`);t(4,w=(w||[]).concat((await f.json()).parties))};he(()=>{b()});const y=async f=>{t(4,w=void 0);const P=await fetch(`/api/party/list?sort=${f.target.value}`);t(4,w=(await P.json()).parties)};async function h(){t(3,g=!0);const f=new FormData;if(f.append("displayName",s),n?.[0]){const P=await we(n[0],{maxSizeMB:1,maxWidthOrHeight:200});f.append("profilePic",P)}try{await fetch("/api/profile",{method:"POST",body:f}),n?.[0]?window.location.reload():re(),ie("Profile updated!")}catch(P){ie("Error updating profile"),console.error(P)}t(3,g=!1)}const k=async()=>{await Ce.signOut(),await fetch("/api/auth",{method:"DELETE"}),re()};function i(){n=this.files,t(1,n)}function v(){s=this.value,t(2,s)}const p=f=>{f.target.scrollTop+f.target.clientHeight>=f.target.scrollHeight&&b()};return r.$$set=f=>{"data"in f&&t(0,l=f.data)},r.$$.update=()=>{r.$$.dirty&2&&t(5,a=n?.[0]&&URL.createObjectURL(n[0]))},[l,n,s,g,w,a,b,y,h,k,i,v,p]}class Be extends ye{constructor(e){super(),be(this,e,Se,De,me,{data:0})}}export{Be as component};
